<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ابزار امن رمزنگاری متن و پنهان‌نگاری (Web Crypto API)">
    <meta name="author" content="443a">
    <meta name="theme-color" content="#0f172a">
    
    <title>کریپتو مسنجر | CryptoMsg</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="assets/icons/icon-192.png">

    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>

    <button id="installBtn"><i class="fas fa-download"></i> نصب اپلیکیشن</button>

    <div class="header-bar">
        <div class="app-title"><i class="fas fa-shield-halved"></i> CryptoMsg <small style="font-size:0.6em; opacity:0.7; margin-right:5px;">Pro</small></div>
        <div class="version-badge" onclick="updateApp()">
            <i class="fas fa-sync-alt"></i> نسخه 4.3 (بروزرسانی)
        </div>
    </div>

    <div class="container">
        <h2>پیام‌رسان سری</h2>

        <div class="tabs">
            <button id="tabEnc" class="tab-btn active enc" onclick="setMode('encrypt')">ارسال (رمزنگاری)</button>
            <button id="tabDec" class="tab-btn" onclick="setMode('decrypt')">دریافت (رمزگشایی)</button>
        </div>

        <div id="encSettings">
            <div class="form-group">
                <label><i class="fas fa-layer-group"></i> روش مخفی‌سازی:</label>
                <select id="encodingMode" onchange="toggleCoverInput()">
                    <option value="base64">استاندارد (Base64) - کپی راحت</option>
                    <option value="farsiChars">حروف تصادفی فارسی (مناسب پیامک)</option>
                    <option value="invisible">متن نامرئی / Steganography ✨</option>
                    <option value="farsiWords">جملات واقعی فارسی (طبیعی)</option>
                    <option value="russian">حروف روسی (ضد فیلتر)</option>
                    <option value="emoji">ایموجی‌ها (😂😎🚀)</option>
                    <option value="chinese">کاراکترهای چینی</option>
                    <option value="englishFake">انگلیسی (Fake English)</option>
                </select>
            </div>

            <div id="coverTextInput" class="form-group">
                <label><i class="fas fa-mask"></i> متن پوششی:</label>
                <input type="text" id="coverText" placeholder="مثلاً: سلام چطوری؟ خوبی؟">
                <div class="hint-text">پیام اصلی شما لابلای این متن مخفی می‌شود.</div>
            </div>

            <label class="checkbox-wrapper" for="splitOutput">
                <input type="checkbox" id="splitOutput" checked>
                <span class="checkbox-label">تقسیم خودکار پیام‌های طولانی (پارت‌بندی)</span>
            </label>
        </div>

        <div class="form-group">
            <label id="inputLabel"><i class="fas fa-pen"></i> متن پیام:</label>
            <textarea id="inputText" rows="3" placeholder="پیام محرمانه خود را بنویسید..." oninput="analyzeInput()"></textarea>
        </div>

        <div id="smartSuggestion" class="smart-suggestion">
            <i class="fas fa-lightbulb"></i> <span id="suggestionText"></span>
        </div>

        <div class="form-group">
            <div class="pass-header">
                <label><i class="fas fa-key"></i> رمز عبور:</label>
                <span class="gen-pass-btn" onclick="generatePassword()">
                    <i class="fas fa-magic"></i> ساخت رمز قوی
                </span>
            </div>
            
            <div class="password-wrapper">
                <input type="password" id="password" placeholder="حداقل ۱۲ کاراکتر..." oninput="checkStrength()">
                <i class="fas fa-eye password-toggle" onclick="togglePass()" id="toggleBtn"></i>
            </div>

            <div class="strength-bar"><div id="strengthFill" class="strength-fill"></div></div>
            <div class="strength-info">
                <span id="strengthText" class="strength-text">قدرت: وارد نشده</span>
                <span id="crackTimeText" class="crack-time"></span>
            </div>
        </div>

        <button id="actionBtn" class="btn-main btn-enc" onclick="process()">
            <i class="fas fa-lock"></i> تولید پیام امن
        </button>

        <div id="resultArea" class="result-container">
            <div class="stats-box">
                <span id="charCount"></span>
                <span id="smsCount"></span>
            </div>
            <div id="outputParts"></div>
        </div>
    </div>

    <div class="info-container">
        
        <details>
            <summary><i class="fas fa-book-open" style="color: var(--primary);"></i> راهنمای ساده (چطور کار کنم؟)</summary>
            <div class="info-content">
                <h4 style="margin-top:0; color:var(--text);">📤 برای ارسال پیام:</h4>
                <ol style="padding-right: 20px; margin-bottom: 15px;">
                    <li><strong>نوشتن:</strong> پیام محرمانه خود را در کادر بنویسید.</li>
                    <li><strong>رمزگذاری:</strong> یک رمز عبور قوی انتخاب کنید (این رمز را باید به گیرنده هم بگویید).</li>
                    <li><strong>انتخاب ظاهر:</strong>
                        <ul>
                            <li><small>🔹 <strong>استاندارد:</strong> برای کپی راحت در تلگرام/واتساپ.</small></li>
                            <li><small>🔹 <strong>متن نامرئی:</strong> اگر می‌خواهید پیام در توییتر/اینستاگرام دیده نشود.</small></li>
                        </ul>
                    </li>
                    <li><strong>ارسال:</strong> دکمه "تولید پیام" را بزنید، متن عجیب تولید شده را کپی کنید و بفرستید.</li>
                </ol>

                <h4 style="color:var(--text);">📥 برای خواندن پیام:</h4>
                <ol style="padding-right: 20px;">
                    <li>روی دکمه <strong>"دریافت (رمزگشایی)"</strong> در بالای صفحه کلیک کنید.</li>
                    <li>متن رمز شده‌ای که دریافت کرده‌اید را در کادر وارد کنید.</li>
                    <li>همان رمز عبوری که فرستنده گذاشته بود را بزنید تا پیام باز شود.</li>
                </ol>
            </div>
        </details>

        <details>
            <summary><i class="fas fa-shield-alt" style="color: var(--warning);"></i> نکات مهم امنیتی (حتما بخوانید)</summary>
            <div class="info-content">
                <ul style="list-style-type: none; padding: 0;">
                    <li style="margin-bottom: 10px;">
                        🚫 <strong>رمز را جداگانه بفرستید:</strong> <br>
                        <span style="font-size: 0.85rem; color: #94a3b8;">هرگز رمز عبور را در همان پیامی که متن رمز شده را می‌فرستید، قرار ندهید. (مثلاً متن را در واتساپ بفرستید و رمز را تلفنی بگویید).</span>
                    </li>
                    <li style="margin-bottom: 10px;">
                        ⌨️ <strong>مراقب کیبوردها باشید:</strong> <br>
                        <span style="font-size: 0.85rem; color: #94a3b8;">کیبوردهای گوشی کلمات شما را یاد می‌گیرند. برای امنیت ۱۰۰٪، از کیبوردهای امن یا حالت Incognito مرورگر استفاده کنید.</span>
                    </li>
                    <li style="margin-bottom: 10px;">
                        📋 <strong>حافظه کپی را پاک کنید:</strong> <br>
                        <span style="font-size: 0.85rem; color: #94a3b8;">بعد از اینکه پیام را کپی و ارسال کردید، یک متن الکی دیگر کپی کنید تا پیام اصلی از حافظه گوشی (Clipboard) پاک شود.</span>
                    </li>
                    <li style="margin-bottom: 10px;">
                        ⚠️ <strong>فراموشی رمز = نابودی پیام:</strong> <br>
                        <span style="font-size: 0.85rem; color: #94a3b8;">چون ما هیچ سروری نداریم، اگر رمز عبور را فراموش کنید، هیچ راهی برای بازگرداندن پیام وجود ندارد.</span>
                    </li>
                </ul>
            </div>
        </details>

        <details open>
            <summary><i class="fas fa-code" style="color: var(--success);"></i> مشخصات فنی (نسخه ۴.۰)</summary>
            <div class="info-content">
                <p><strong>امنیت هسته جدید (Web Crypto API):</strong></p>
                <p style="text-align: justify; font-size: 0.85rem;">
                    در این نسخه، ما از موتور رمزنگاری داخلی مرورگر استفاده می‌کنیم که سریع‌تر و امن‌تر است.
                    <br><br>
                    🔹 <strong>الگوریتم:</strong> AES-GCM (256-bit) - این الگوریتم اگر پیام در طول مسیر حتی یک نقطه تغییر کرده باشد، آن را باز نمی‌کند (ضد دستکاری).
                    <br>
                    🔹 <strong>کلیدسازی:</strong> PBKDF2 با ۱۰۰,۰۰۰ بار تکرار و Salt تصادفی (ضد حملات هکری).
                    <br>
                    🔹 <strong>بدون سرور:</strong> تمام عملیات در گوشی شما انجام می‌شود.
                </p>
            </div>
        </details>
    </div>

    <script src="assets/js/app.js"></script>
</body>
</html>

```